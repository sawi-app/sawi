generator client {
  provider = "prisma-client-js"
}
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Address {
  id       String  @id
  refer_to String
  street   String?
  street2  String?
  city     String?
  state    String?
  zip_code String?
  country  String?
  lat      String?
  lng      String?
}


model Organisation {
  id                 String  @id
  reference          String
  name               String?
  logo               String?
  commercial_register String?
  tax_id_number      String?
  customs_code       String?
  tel                String[] 
  establishments Establishment[]
  deposits    Deposit[]
  locations    Location[]
  contactTypes  ContactType[]
  banks        Bank[]
  bankAccounts  BankAccount[]
  taxes         Tax[]
  vats         Vat[]
  currencies    Currency[]
  currencyCoefficients CurrencyCoefficient[]
  discounts           Discount[]
  contacts            Contact[]
  providers            Provider[]
}

model Establishment {
  id           String   @id
  id_org       String   @map("id_org") 
  referencee   String   @unique
  designation  String?
  currency     String?
  organisation Organisation @relation(fields: [id_org], references: [id])
  deposits     Deposit[]
  locations    Location[]
  contactTypes ContactType[]
  bankAccounts  BankAccount[]
  taxes         Tax[]
  vats         Vat[]
  currencies    Currency[]
  currencyCoefficients CurrencyCoefficient[]
  discounts           Discount[]
  contacts            Contact[]
  providers            Provider[]
}

model Deposit {
  id           String      @id
  id_org       String      @map("id_org") 
  id_etb       String      @map("id_etb") 
  reference    String      @unique
  designation  String?
  type         String

  organisation Organisation @relation(fields: [id_org], references: [id])
  establishment Establishment @relation(fields: [id_etb], references: [id])

  locations    Location[]
}

model Location {
  id           String      @id
  id_org       String      @map("id_org")
  id_etb       String      @map("id_etb") 
  id_depo      String      @map("id_depo") 
  reference    String      @unique
  designation  String?
  volume       String?
  organisation Organisation @relation(fields: [id_org], references: [id])
  establishment Establishment @relation(fields: [id_etb], references: [id])
  deposit      Deposit     @relation(fields: [id_depo], references: [id])
}

model ContactType {
  id           String      @id
  id_org       String      @map("id_org")
  id_etb       String      @map("id_etb") 
  reference    String      @unique
  designation  String?
  organisation Organisation @relation(fields: [id_org], references: [id])
  establishment Establishment @relation(fields: [id_etb], references: [id])
  contacts            Contact[]
}

model Bank {
  id           String      @id
  id_org       String      @map("id_org") 
  reference    String      @unique
  designation  String?
  organisation Organisation @relation(fields: [id_org], references: [id])
  bankAccounts  BankAccount[]
}

model BankAccount {
  id           String      @id
  id_org       String      @map("id_org")
  id_etb       String      @map("id_etb") 
  id_bank      String      @map("id_bank")
  reference    String      @unique
  RIB          String
  organisation Organisation @relation(fields: [id_org], references: [id])
  establishment Establishment @relation(fields: [id_etb], references: [id])
  bank         Bank         @relation(fields: [id_bank], references: [id])
  contacts            Contact[]
  providers            Provider[]
}

model Tax {
  id           String      @id
  id_org       String      @map("id_org")
  id_etb       String      @map("id_etb")
  reference    String      @unique
  designation  String?
  value        Float?
  tax_type     String?
  organisation Organisation @relation(fields: [id_org], references: [id])
  establishment Establishment @relation(fields: [id_etb], references: [id])
  providers            Provider[]
}


model Vat {
  id           String      @id
  id_org       String      @map("id_org") 
  id_etb       String      @map("id_etb") 
  reference    String      @unique
  designation  String?
  value        Float?
  organisation Organisation @relation(fields: [id_org], references: [id])
  establishment Establishment @relation(fields: [id_etb], references: [id])
  contacts            Contact[]
  providers            Provider[]
}

model Currency {
  id           String      @id
  id_org       String      @map("id_org") 
  id_etb       String      @map("id_etb") 
  reference    String      @unique
  designation  String?
  symbol       String?
  organisation Organisation @relation(fields: [id_org], references: [id])
  establishment Establishment @relation(fields: [id_etb], references: [id])
  currencyCoefficientsFrom CurrencyCoefficient[] @relation("CurrencyFrom")
  currencyCoefficientsTo   CurrencyCoefficient[] @relation("CurrencyTo")
}

model CurrencyCoefficient {
  id                 String      @id
  id_org             String      @map("id_org") 
  id_etb             String      @map("id_etb") 
  reference          String      @unique
  designation        String?
  value              Float?
  id_currency_from   String      @map("id_currency_from") 
  id_currency_to     String      @map("id_currency_to") 
  organisation       Organisation @relation(fields: [id_org], references: [id])
  establishment      Establishment @relation(fields: [id_etb], references: [id])
  currency_from      Currency     @relation("CurrencyFrom", fields: [id_currency_from], references: [id])
  currency_to        Currency     @relation("CurrencyTo", fields: [id_currency_to], references: [id])
}

model Discount {
  id                  String               @id
  id_org              String               @map("id_org") 
  id_etb              String               @map("id_etb") 
  reference           String               @unique
  designation         String?
  value               Float?
  effect_date         DateTime
  end_date            DateTime
  organisation        Organisation         @relation(fields: [id_org], references: [id])
  establishment       Establishment        @relation(fields: [id_etb], references: [id])
}


model Contact {
  id                  String               @id
  id_org              String               @map("id_org") 
  id_etb              String               @map("id_etb") 
  id_type_contact     String               @map("id_type_contact") 
  id_vat              String               @map("id_vat") 
  id_bank_account     String               @map("id_bank_account") 
  reference           String               @unique
  first_name          String?
  last_name           String?
  company_name        String?
  email               String?
  tel                 String?
  personal_id_type    String?
  personal_id         String?
  tax_id_number       String?
  customs_code        String?
  nature              Nature
  organisation        Organisation         @relation(fields: [id_org], references: [id])
  establishment       Establishment        @relation(fields: [id_etb], references: [id])
  contactType         ContactType           @relation(fields: [id_type_contact], references: [id])
  vat                 Vat                  @relation(fields: [id_vat], references: [id])
  bankAccount         BankAccount           @relation(fields: [id_bank_account], references: [id])
}


model Provider {
  id                  String               @id
  id_org              String               @map("id_org") 
  id_etb              String               @map("id_etb") 
  id_vat              String               @map("id_vat") 
  id_tax              String               @map("id_tax") 
  id_bank_account     String               @map("id_bank_account")
  reference           String               @unique
  first_name          String?
  last_name           String?
  company_name        String?
  email               String?
  tel                 String?
  personal_id_type    String?
  personal_id         String?
  tax_id_number       String?
  customs_code        String?
  nature              Nature
  organisation        Organisation         @relation(fields: [id_org], references: [id])
  establishment       Establishment        @relation(fields: [id_etb], references: [id])
  vat                 Vat                  @relation(fields: [id_vat], references: [id])
  tax                 Tax                  @relation(fields: [id_tax], references: [id])
  bankAccount         BankAccount           @relation(fields: [id_bank_account], references: [id])
}

enum Nature {
  COMPANY
  INDIVIDUAL
}